<!--
FPempresa
Copyright (C) 2020  Lorenzo González

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see http://www.gnu.org/licenses/
-->

<div class="row">
    <div class="col-xs-12 form__container" >
        <div>
            <ix3-business-messages></ix3-business-messages>
            <form name="mainForm" id="mainForm"  ix3-form>
                <fieldset>
                    <legend class="form__title">Oferta</legend>
                    <br>
                    <div class="row" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="form-group">
                                <label  class="col-xs-3  control-label" for="empresa.nombreComercial" >Empresa</label>
                                <div  class="input-group col-xs-9" ng-click="buscarEmpresa()" style="cursor: pointer">
                                    <span class="input-group-addon"  ><i class="glyphicon glyphicon-search"></i></span>
                                    <input ng-model="model.empresa.nombreComercial" class="form-control" id="empresa.nombreComercial" name="empresa.nombreComercial" type="text" ng-keypress="buscarEmpresa()"  ng-readonly="true" placeholder="Seleccione la empresa que ofrece la oferta" style="background-color: #FFFFFF;cursor: pointer" ix3-validation />
                                </div> 
                            </div> 
                        </div>
                    </div>

                    <div class="row" ng-show="controllerAction == 'NEW'" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="col-sm-9 col-sm-offset-3">
                                <p class="form__text form__text--help">Debe comunicar a la empresa que la oferta va a ser publicada en empleaFP.<br>Para ello puede usar la siguiente plantilla: <a href="{{getContextPath()}}/documentos/rgpd_empresa.docx" class="c-button c-button--alt-tertiary">rgpd_empresa.docx</a></p>
                            </div>
                        </div> 
                    </div>                  
                    
                    <div class="row" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="form-group">
                                <label for="puesto" class="col-xs-3  control-label" ix3-label></label>
                                <div class="col-xs-9 ">
                                    <input ng-model="model.puesto" type="text" class="form-control" id="puesto" name="puesto"  ix3-validation>
                                </div>
                            </div> 
                        </div>
                    </div>

                    <div class="row" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="form-group">
                                <label for="descripcion" class="col-xs-3  control-label" ix3-label></label>
                                <div class="col-xs-9">
                                    <textarea ng-model="model.descripcion" class="form-control" rows="7"  id="descripcion" name="descripcion"  ix3-validation></textarea>
                                </div>
                            </div> 
                        </div>
                    </div>  
                    <div class="row" >
                        <div class="col-xs-12 col-xs-12 col-xs-offset-3  form-horizontal">
                            <div class="checkbox">
                                <label>
                                    <input ng-model="model.cerrada" type="checkbox" >
                                    Oferta cerrada. Ya no se permitir&aacute; a&ntilde;adir nuevos candidatos.
                                </label>
                            </div>
                        </div> 
                    </div>                     
                    <br>
                    <legend class="form__title">Municipio del lugar de trabajo</legend>
                    <div class="row" >
                        <div class="col-xs-12 col-sm-6  form-horizontal">
                            <div class="form-group">
                                <label for="municipio.provincia" class="col-xs-3 col-sm-6 control-label" ix3-label></label>
                                <div class="col-xs-9 col-sm-6">
                                    <select ng-model="model.municipio.provincia" id="municipio.provincia" name="municipio.provincia" class="form-control" ix3-options="orderBy:'descripcion'" ix3-validation >
                                        <option value="">-- Elige Opcion --</option>
                                    </select>
                                </div>
                            </div> 
                        </div>
                        <div class="col-xs-12 col-sm-6  form-horizontal">
                            <div class="form-group">
                                <label for="municipio" class="col-xs-3 col-sm-6 control-label" ix3-label></label>
                                <div class="col-xs-9 col-sm-6">
                                    <select ng-model="model.municipio" id="municipio" name="municipio" class="form-control" ix3-options="orderBy:'descripcion'"  ix3-validation ix3-options-depend="{provincia:model.municipio.provincia}" >
                                        <option value="">-- Elige Opcion --</option>
                                    </select>
                                </div>
                            </div> 
                        </div> 
                    </div> 

                    <legend class="form__title">Datos de contacto</legend>       
                    <div class="row" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="col-sm-9 col-sm-offset-3">
                                <p class="form__text form__text--help">Los titulados que se inscriban en esta oferta deben necesariamente de ponerse directamente en contacto con la empresa a traves de los datos que se suministran en este campo</p>
                            </div>
                        </div> 
                    </div>                     
                    <div class="row" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="form-group">
                                <label for="contacto.textoLibre" class="col-sm-3  control-label" ix3-label ></label>
                                <div class="col-sm-9">
                                    <textarea ng-model="model.contacto.textoLibre" class="form-control" rows="4"  id="contacto.textoLibre" name="contacto.textoLibre"  ix3-validation></textarea>
                                </div>
                            </div> 
                        </div> 
                    </div>                     

                    <legend class="form__title">Destinado a personas de</legend>                    
                    <div class="row" >
                        <div class="col-xs-12 form-horizontal"> 
                            <div class="form-group">
                                <label for="familia" class="col-sm-3  control-label" ix3-label ></label>
                                <div class="col-sm-7">
                                    <select ng-model="model.familia" id="familia" name="familia" class="form-control" ix3-options="orderBy:'descripcion'"  >
                                        <option value="">-- Elige Opcion --</option>
                                    </select>
                                </div>
                            </div> 
                        </div> 
                    </div>    

                    <div class="row" >
                        <div class="col-xs-9 col-xs-offset-3">
                            <div >
                                <p class="form__text form__text--help"><i class="fa fa-warning"></i>&nbsp;Recuerda que solo podrán ver la oferta aquellos titulados que posean alguno de los ciclos que vas de indicar </p> 
                            </div>
                        </div>
                    </div>


                    <div class="row" >
                        <div class="col-xs-12  form-horizontal">
                            <div class="form-group">
                                <label class="col-xs-3  control-label"  >Ciclos</label>
                                <div class="col-xs-9">
                                    <table class="table table-bordered">
                                        <thead>                        
                                            <tr class="data-table__head">
                                                <th style="width:   1%;text-align: center"><input type="checkbox" ng-model="todosCiclos" ng-click="checkTodosCiclos(todosCiclos)"></th>
                                                <th style="width:   55%;text-align: center">Ciclo</th>
                                                <th style="width:   27%;text-align: center">Grado</th>
                                                <th style="width:   18%;text-align: center">Ley Educativa</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="ciclo in ciclos" class="data-table__row">
                                                <td ><input type="checkbox" checklist-model="model.ciclos" checklist-value="ciclo" checklist-comparator="compareCiclo"></td>
                                                <td >{{ciclo.descripcion}}</td>
                                                <td >{{ciclo.grado.toString()}}</td>                   
                                                <td >{{ciclo.leyEducativa.toString()}}</td>                             
                                            </tr>
                                        </tbody>
                                    </table> 
                                </div>
                            </div> 
                        </div> 
                    </div>  

                    <div class="row" ng-show="controllerAction !== 'NEW'" >
                        <div class="col-xs-12  form-horizontal">

                            <legend class="form__title">Candidatos</legend>

                            <div class="form-group">
                                <div class="col-sm-7 col-sm-offset-4 col-xs-12 ">

                                    <div class="panel panel-green">
                                        <div class="panel-heading">
                                            <div class="row">
                                                <div class="col-xs-3">
                                                    <i class="fa fa-archive fa-4x"></i>
                                                </div>
                                                <div class="col-xs-9 text-right">
                                                    <div class="section__text--size-high" ng-show="numCandidatosOferta>0">{{numCandidatosOferta}}</div>
                                                    <div class="section__text--size-high"><ng-pluralize count="numCandidatosOferta" when="{'0': 'Ningún Candidato','1': 'Candidato','other': 'Candidatos'}"></ng-pluralize></div>
                                                </div>
                                            </div>
                                            
                                        </div>
                                        <div class="panel-body" ng-show="numCandidatosOferta>0">
                                            <ul>
                                                <li ng-repeat="candidato in candidatos" >{{candidato.fecha | date: 'dd/MM/yyyy'}}&nbsp;&nbsp;&nbsp;&nbsp;{{candidato.usuario.nombre}} {{candidato.usuario.apellidos}}</li>
                                            </ul>
                                            <a href="javascript:void(0)" ng-click="searchCandidatos(pageCandidatos.pageNumber+1)" ng-show="pageCandidatos.pageNumber+1<pageCandidatos.totalPages">Cargar mas candidatos...</a>
                                        </div>
                                    </div>
                                </div> 


                            </div> 
                        </div>
                    </div> 
                    <br>
                    <div class="row" >
                        <div class="col-xs-12 ">
                            <br>
                            <crud-detail-buttons class="pull-right" ></crud-detail-buttons>
                        </div>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
</div>

